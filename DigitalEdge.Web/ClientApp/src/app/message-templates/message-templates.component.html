<!-- page content -->
<side-bar></side-bar>
<topnav-bar></topnav-bar>
<div class="right_col " role="main" style="min-height:1675px">

  <div class="row">
    <div class="col-md-12 col-sm-12 col-xs-12">
      <div class="dashboard_graph">
        <h2>MessageTemplates </h2>
        <p>
          <a style="float: right;padding: 20px;font-weight: bold;" (click)="openModal(template,true)"><i class="icons fa fa-plus" title="Add Message"> Message</i></a>
        </p>
        <table class='table' *ngIf="messageTemplateList != undefined">
          <thead>
            <tr>
              <th>Message</th>
              <th>Language</th>
              <th>Type</th>
              <th>Timed</th>
              <th>Status</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngIf="messageTemplateList?.length == 0">
              <td colspan="6" class="text-center font-weight-bolder" style="font-size: xx-large;color: grey"> NO RECORD FOUND</td>
            </tr>
            <tr *ngFor="let data of messageTemplateList;let i = index">
              <td>{{data.message}}</td>
              <td>{{data.language}}</td>
              <td>{{data.type}}</td>
              <td>{{data.timed}}</td>
              <td>{{data.status}}</td>
              <td>
                <a (click)="EditMessageTemplate(data,template)"><i class="icons fa fa-edit" title="Edit"></i></a>
                <a (click)="deleteMessageTemplatePopup(this.modalDefault,data)"><i class="icons fa fa-trash" title="Delete"></i></a>
              </td>
            </tr>
          </tbody>
        </table>


        <ng-template #template>
          <div class="modal-header">
            <h4 class="modal-title pull-left">Add Template</h4>
            <br />
            <h5 style="color:red">{{ErrorMessage}}</h5>
            <button type="button" class="close pull-right" aria-label="Close" (click)="closePopup()">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="form-group row">
              <label class="col-md-3" for="Type"><b>Type</b></label>
              <div class="col-md-9">
                <select class="form-control" [ngClass]="{ 'is-invalid':  emptyType }" (change)="GetType($event.target.value)" id="selectType">
                  <option disabled="disabled">Select Type</option>
                  <option *ngFor="let item of selectType" [selected]="item.isSelected == true" [value]="item.value">{{item.value}}</option>
                </select>
                <div *ngIf="emptyType" class="invalid-feedback">
                  <div>
                    Please select any type value !
                  </div>
                </div>
              </div>
            </div>
            <div class="form-group row">
              <label class="col-md-3" for="Type"><b>Timed</b></label>
              <div class="col-md-9" style="display: inline-flex;">
                <div *ngFor="let entry of selectTimed">
                  <div style="display: inline-flex;">
                    <div class="col-md-5">{{ entry.name }}</div>
                    <div class="col-md-1">
                      <input type="radio" name="selectTimed"
                             [checked]="entry.isSelected === true"
                             [value]="entry.value"
                             (change)="GetTimed($event.target.value)" />
                    </div>
                  </div>
                </div>
                <div *ngIf="emptyTimed" class="alert alert-danger">
                  <div>
                    Please select any timed value !
                  </div>
                </div>
              </div>
            </div>
            <div class="form-group row">
              <label class="col-md-3" for="Status"><b>Status</b></label>
              <div class="col-md-9" style="display: inline-flex;">
                <div *ngFor="let entry of selectStatus">
                  <div style="display: inline-flex;">
                    <div class="col-md-5">{{ entry.name }}</div>
                    <div class="col-md-1">
                      <input type="radio" name="selectStatus"
                             [checked]="entry.isSelected === true"
                             [value]="entry.value"
                             (change)="GetAddStatusValue($event.target.value)" />
                    </div>
                  </div>
                </div>
                <div *ngIf="emptyStatus" class="alert alert-danger">
                  <div>
                    Please select any Status value !
                  </div>
                </div>
              </div>
            </div>
            <div class="form-group row">
              <label class="col-md-3" for="Language"><b>Language</b></label>
              <div class="col-md-9">
                <select class="form-control" [ngClass]="{ 'is-invalid':  emptyLanguage }" (change)="GetLanguage($event.target.value)" id="selectLanguage">
                  <option disabled="disabled">
                    Select Language
                  </option>
                  <option *ngFor="let item of selectLanguage" [selected]="item.isSelected == true" [value]="item.value">{{item.value}}</option>
                </select>
                <div *ngIf="emptyLanguage" class="invalid-feedback">
                  <div>
                    Please select any language value !
                  </div>
                </div>
              </div>
            </div>

            <div class="form-group row">
              <label class="col-md-3" for="message"><b>Message</b></label>
              <div class="col-md-9">
                <textarea class="form-control" [ngClass]="{ 'is-invalid':  emptyMessage }" [(ngModel)]="messageTemplate.Message" name="message" rows="5" (keyup)="GetMessage()" #Message="ngModel" required>
	    	        </textarea>
                <div *ngIf="emptyMessage" class="invalid-feedback">
                  <div>
                    Message is required.
                  </div>
                </div>
              </div>
              <div class="col-xs-12">
                <div class="dropdown s-sms-dropdown overflow-dropdown pull-left">
                  <a class="" id="shortCodeDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <span class="insert-shortCode-text"> Insert Shortcode</span>
                  </a>
                  <div class="dropdown-menu custom-scrollbar" aria-labelledby="shortCodeDropdown">
                    <a class="dropdown-item" *ngFor="let shortCode of insertShortCode, let codeIndex= index;" (click)="shortCode.isHeading ? '' : placeShortCodeInMessage(codeIndex)">
                      <span [ngClass]="shortCode.isHeading ? 'header-text': 'shortCode-text'">{{shortCode.name}} <br /></span>
                    </a>
                  </div>
                </div>
              </div>

            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" (click)="AddMessageTemplate()">Save changes</button>
            <button type="button" class="btn btn-secondary" data-dismiss="modal" (click)="closePopup()">Close</button>
          </div>
        </ng-template>

      </div>
    </div>

  </div>
  <br />
</div>
<custom-footer></custom-footer>
<!-- /page content -->

<ng-template #modalDefault>
  <div class="modal-header">
    <h4 class="modal-title" style="color:black!important">Delete Template</h4>
    <button type="button" class="close basic-close" (click)="CancelDelete(this.modalDefault)">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <p>Are You sure you want to delete this MessageTemplate ? </p>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-default waves-effect" (click)="CancelDelete(this.modalDefault)">CLOSE</button>
    <button type="button" (click)="DeleteMessageTemplate()" class="btn btn-primary waves-effect waves-light">Delete</button>
  </div>
</ng-template>
