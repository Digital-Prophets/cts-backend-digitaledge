<!-- page content -->
<side-bar></side-bar>
<topnav-bar></topnav-bar>
<div class="right_col " role="main" style="min-height:1675px">

  <div class="row">
    <div class="col-md-12 col-sm-12 col-xs-12">
      <div class="dashboard_graph">
        <h2>Users </h2>
        <p>
          <a [routerLink]="['/register-user']" style="float: right;padding: 20px;font-weight: bold;"><i class="icons fa fa-plus" title="Add User"> User</i></a>
        </p>
        <table class='table'>
          <thead>
            <tr>
              <th>First Name</th>
              <th>Last Name</th>
              <th>Email</th>
              <th>Phone No.</th>
              <th>Gender</th>
              <th>Role Name</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngIf="this.users?.length == 0">
              <td colspan="7" class="text-center font-weight-bolder" style="font-size: xx-large; color:grey;"> NO RECORD FOUND</td>
            </tr>
            <tr *ngFor="let user of  this.users">
              <td>{{user.firstName}}</td>
              <td>{{user.lastName}}</td>
              <td>{{user.email}}</td>
              <td>{{user.phoneNo}}</td>
              <td>{{user.gender}}</td>
              <td>{{user.roleName}}</td>
              <td>
                <a [routerLink]="['/user/edit/', user.id]"><i class="icons fa fa-edit" title="Edit" ></i></a> 
                <a [routerLink]="" (click)="deletepopup(user)"><i class="icons fa fa-trash" title="Delete" ></i></a> 
                <a [routerLink]="" (click)="facilitypopup(editProfileModal ,user)"><i class="icons fa fa-facility" title="Add Facility" ></i></a>
              </td>
            </tr>
          </tbody>
        </table>
        <div class="clearfix"></div>
      </div>
    </div>

  </div>
  <br />
</div>
<custom-footer></custom-footer>
<ng-template #editProfileModal let-modal>
  <div class="modal-header">
    <h5 class="modal-title" id="editProfileLabel">Assign Facility</h5>
    <button type="button" class="close" (click)="close()" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <form [formGroup]="editProfileForm" (ngSubmit)="onSubmit()">
      <div class="form-group row">
        <label for="email" class="col-sm-4 col-form-label">Email</label>
        <div class="col-sm-8">
          <input disabled="disabled" type="email" class="form-control" formControlName="email" id="email">
        </div>
      </div>
      <div class="form-group row">
        <label class="col-sm-4 col-form-label">
          Facility Name
        </label>
        <div class="col-sm-8 ">
          <select class="select2_group form-control"[ngClass]="{ 'is-invalid':  isSubmitted && g.facility.errors }" formControlName="facility" (change)="GetServicePointId($event.target.value)">
            <option value="" disabled="disabled" >Select Facility </option>
            <option *ngFor="let facility of FacilityList"[value]="facility.facilityId">{{facility.facilityName}}</option>
          </select>
          <div class="invalid-feedback" *ngIf=" isSubmitted && g.facility.errors?.required">
            <sup>*</sup>Facility Name is required
          </div>
        </div>
      </div>
      <div class="form-group row">
        <label class="col-sm-4 col-form-label">
          Service Point Name
        </label>
        <div class="col-sm-8 ">
          <select class="select2_group form-control" [ngClass]="{ 'is-invalid':  isSubmitted && g.servicepoint.errors }"  formControlName="servicepoint">
            <option value="" disabled="disabled">Select Service Point</option>
            <option *ngFor="let servicePoint of ServicePointList"   [value]="servicePoint.servicePointId">{{servicePoint.servicePointName}}</option>
          </select>
          <div class="invalid-feedback" *ngIf=" isSubmitted && g.servicepoint.errors?.required">
            <sup>*</sup>Service Point Name is required
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="close()">Close</button>
        <button type="submit" class="btn btn-primary">Save</button>
      </div>
    </form>
  </div>
  <div class="row">
    <div class="col-md-12 col-sm-12 col-xs-12">
      <div class="dashboard_graph">
        <table class='table'>
          <thead>
            <tr>
              <th>User Name</th>
              <th>Facility</th>
              <th>Service Point</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let facilityuser of  this.facilitylist">
              <td>{{facilityuser.userName}}</td>
              <td>{{facilityuser.facilityName}}</td>
              <td>{{facilityuser.servicePointName}}</td>
              <td>
                <a [routerLink]="" (click)="deleteFacilitypopup(facilityuser)">Delete</a>
              </td>
            </tr>
          </tbody>
        </table>
        <div class="clearfix"></div>
      </div>
    </div>
  </div>
</ng-template>

<!-- /page content -->
